# <span style="color: #5c8aff">Простой мессенджер</span>

## <span style="color: #7230ff">Краткое описание проекта</span>
  Это простая реализация мессенджера, в которой есть 2 страницы: регистрации\авторизации и главная. На главной странице 
показывается список всех пользователей (используется пагинация). При выборе пользователя открывается чат, в котором можно
обмениваться сообщениями в реальном времени.

Также сделан простой тг-бот с двумя функциями: 1) можно отправить ему email, чтобы привязать тг-аккаунт к аккаунту
приложения; 2) отправить пользователю уведомление о том, что ему прислали новое сообщение (уведомление отправляется только
в том случае, если пользователь в данный момент находится офлайн).

**P.S. В гит специально загружен .env файл с паролями, тг токеном и т.д., чтобы проект можно было быстро и без проблем
запустить локально**

## <span style="color: #fbff00">Используемый стек</span>
- Python 3.10
- PostgreSQL 16
- SQLAlchemy 2.0
- FastAPI
- FastAPI Users
- Pydantic
- Alembic
- Redis
- Websockets
- Aiogram
- Celery
- Docker и Docker-compose
- Nginx
- Локальная ОС:
    + Windows 10
- Образ ОС в docker-контейнере:
    + python:3.10-alpine

## <span style="color: #f00">Как запустить?</span>
 Для запуска приложения достаточно запустить docker-compose следующей командой:
```
    docker-compose up --build --force-recreate -d
```
После этого приложение будет доступно по адресу http://localhost/

#### При запуске контейнера в базу будет сразу добавлен пользователь с правами администратора. Его логин: "root@gmail.com", пароль: "root" 
## <span style="color: #00ff1a">Документация и тестирование API</span>

- Документация к API доступна по адресу: http://localhost/docs (автоматически сгенерированная)
  
## <span style="color: #f81">Что реализовано?</span>
- контейнеризация с использованием ***Docker и Docker-compose***
- простая конфигурация nginx
- описаны модели БД с использованием ***SQLAlchemy ORM***
- миграция БД с использованием ***alembic***
- валидация данных с использованием ***Pydantic***
- система аутентификации с использованием ***FastAPI Users***. Авторизация реализована через JWT-токен, передаваемый в cookies
- обмен сообщениями в реальном времени при помощи ***Websockets*** и ***Redis Pub\Sub***
- пагинация и сортировка для получения списка пользователей
- пагинация при получении истории сообщений
- кеширование истории сообщений и списка пользователей в ***Redis***. Список пользователей в кеше обновляется при
регистрации нового пользователя, а история сообщений храниться 30 минут (таймер обновляется при отправке нового сообщения).
- отслеживание статуса online / offline пользователя при помощи ***Websockets*** и ***Redis***
- задача на отправку уведомления в телеграм с помощью ***Celery***
- простой телеграм-бот: **@test_messanger_notification_bot**. Его возможности:
  + связать свой аккаунт в приложении с аккаунтом телеграм, отправив боту email, использованный при регистрации в приложении
  + отправить уведомление о новом сообщении
- Просто веб интерфейс с использованием шаблонов ***Jinja*** (страница для регистрации / авторизации и главная страница
со списокм всех пользователей и чатом) (применяется пагинация для истории сообщений и для списка пользователей)

